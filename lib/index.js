"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],c=0,a=o.length;c<a;c++,i++)n[i]=o[c];return n}var capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},whitEnumPusher=function(e){return e+": Enum"+capitalize(e)+";"},checkType=function(e,t){return e.typeReplace[t]||t},getDescription=function(e){var t=e.description;return t?"// "+t:"// NO DESCRIPTION"},openApi2=function(e){var t=e.regexpMethods,r=e.modificators,n=function(e,r){if(!t.excludeDTO.test(e)&&r)return"export interface "+function(e){if(t.nameInterface.test(e)){var r=e.match(t.nameInterface);return r?r[1]:r}return e.split("[")[0]}(e)+" {"+r+"}"};return function(e){var i=e.definitions,o=[],c=[],a=Object.keys(i).map((function(e){var a=i[e].properties,p=Object.keys(a).map((function(e){var n,i=a[e],p=(i.pagination,__rest(i,["pagination"]));return"enum"in p?(c.includes(e)||o.push((n=p,"export enum Enum"+capitalize(e)+" {\n  "+n.enum.map((function(e){return e+" = '"+e+"', "+getDescription(n)})).join("\n  ")+",\n}")),c.push(e),whitEnumPusher(e)):function(e,n){var i,o=function(t){return"\n  "+e+": "+(r.interfaceReplace[t]||t)+"; "+getDescription(n)+"\n"};return"array"===n.type?n.items.$ref?o(i=n.items.$ref.match(t.matchInterfaceName)[1]+"[]"):o(checkType(r,n.items.type)+"[]"):o("$ref"in n?(i=n.$ref.match(t.matchInterfaceName))?i[1]:i:checkType(r,n.type))}(e,p)})).join("");return n(e,p)}));return __spreadArrays(o,a).join("\n").replace(t.replaceSpace,"")}},openApi3=function(e){var t=e.regexpMethods,r=e.modificators,n=function(e){return e.join("\n").replace(t.replaceSpace,"")},i=function(e,t){return"export enum "+e+" {\n  "+t.enum.map((function(e){return e+' = "'+e+'", '+getDescription(t)})).join("\n  ")+"\n}"},o=function(e,t){for(var i=[],o=[],c=function(e){return e.replace(/^\#\/components\/schemas\//gm,"")},a=function(e){for(var t=checkType(r,e.type),n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];if(e[o]instanceof Object){var a=e[o];a.hasOwnProperty("$ref")?t=c(a.$ref):a.hasOwnProperty("type")&&(t=checkType(r,a.type))}}return t},p=function(e){var n=t.properties[e];o.push(e+": "+(n.$ref?c(n.$ref):"array"===n.type?a(n)+"[]":"object"===n.type?a(n):checkType(r,n.type))+"; "+getDescription(n))},u=0,s=Object.keys(t.properties);u<s.length;u++){p(s[u])}return i.push("export interface "+e+" {\n  "+o.join("\n ")+"\n}"),n(i)};return function(e){for(var r=e.components.schemas,c=[],a=[],p=0,u=Object.keys(r);p<u.length;p++){var s=u[p];s.startsWith("Enum")||r[s].hasOwnProperty("enum")?c.push(i(s,r[s])):t.excludeDTO.test(s)||a.push(o(s,r[s]))}return n(__spreadArrays(c,a))}},fs=require("fs"),gitDiff=require("git-diff"),http=require("http"),index=function(e){var t=e.API,r=e.regexpMethods,n=e.modificators,i=e.filePath;return http.get(t,(function(e){var t=e.statusCode,o=function(e){return e&&console.log(e)},c=function(e){e&&fs.readFile(i,"utf8",(function(t,r){r&&console.log(gitDiff(r,e,{color:!0,wordDiff:!0,noHeaders:!0})||"no changes"),fs.writeFile(i,e,o)}))};if(200===t){e.setEncoding("utf8");var a="";e.on("data",(function(e){a+=e})),e.on("end",(function(){try{var e=JSON.parse(a);if(e.openapi.startsWith("3")){var t=openApi3({regexpMethods:r,modificators:n})(e);return c(t)}if(e.openapi.startsWith("2")){var i=openApi2({regexpMethods:r,modificators:n})(e);return c(i)}}catch(e){console.error(e.message)}}))}}))};module.exports=index;
//# sourceMappingURL=index.js.map
